# K230 电赛视觉工具库 (K230 Vision Tools)

本项目包含一系列基于嘉楠科技 (Canaan) K230 平台的 Python 视觉处理脚本，专为电子设计竞赛 (电赛) 准备。代码涵盖了从基础的摄像头操作、图形绘制，到进阶的人脸识别、物体分类等 AI 应用，还有历年电赛 K230 赛题整理。

## 目录结构 (Directory Structure)

*   **01_Basic_Learning/**: 基础教程，包括摄像头调用、几何图形识别（线、圆、矩形）、颜色追踪、二维码/条形码识别等。
*   **02_Data_Collection/**: 数据采集工具，包括自动拍照、串口通信（UART）等，用于制作数据集。
*   **03_AI_Demo/**: 进阶 AI 示例，包含：
    *   人脸分析 (Face Analysis)
    *   人体检测 (Human Detection)
    *   手势识别 (Hand Inspection)
    *   目标跟踪
*   **04_Number_Classification/**: 数字分类工程，包含完整的模型部署代码和测试数据。
*   **05_OpenCV_Porting/**: OpenCV 移植相关示例。
*   **平时练习/**: 学习过程中的零散练习与测试代码。
*   **电赛赛题K230/**: 历年电赛 K230 赛题整理 (包含 2021, 2023, 2024 年资料及 2025 年原创代码)。

## 2025年电赛E题 (简易自行瞄准装置) 方案详解

在 `电赛赛题K230/04_2025_E_SelfAiming/Result` 目录下，我们提供了针对不同比赛策略的三个版本主程序。

### 1. 代码版本选择指南

| 版本 | 文件名 | 特点与适用场景 |
| :--- | :--- | :--- |
| **速度优先** | `main（可阈值调节高帧）.py` | **唯快不破**。使用基础的色块查找 (`find_blobs`)，计算量小，帧率极高。适合目标移动速度快、背景较纯净的场景。 |
| **精度优先** | `main（可阈值调节高识别）.py` | **火眼金睛**。引入 `cv_lite` 高级几何检测（Canny边缘、多边形拟合），确保识别到的是标准四边形。适合光照复杂、对精度要求高的场景。 |
| **抗干扰优先** | `main（多限制条件）.py` | **严谨稳重**。增加了“外框套内框”的嵌套逻辑判断，并结合卡尔曼滤波。适合赛场有干扰物（如假靶）的复杂环境。 |

### 2. 独家功能：离线触摸屏调阈值

为解决比赛现场光线变化导致的识别失效问题，我们开发了**免烧录调参功能**：

*   **功能**: 在K230屏幕上实时预览二值化效果，通过触摸拖动滑块调整阈值。
*   **操作**: 按下板载按键(GPIO53)进入，左屏看效果，右屏调参数。调好后点“保存”即刻生效。

### 3. ⚠️ 环境干扰与使用警告 (Known Issues)

**本代码对光线和环境较为敏感，请务必注意：**

1.  **光线是关键**: 不同的场地光照会导致二值化阈值完全不同。**切勿直接使用代码中的默认阈值上场！** 务必在比赛现场使用“触摸屏调阈值”功能重新校准。
2.  **背景纯净度**: 如果背景中存在大量与靶纸颜色相近的物体，**高帧版**代码极易误识别。此时应切换到**多限制条件版**，利用几何特征过滤干扰。
3.  **重启失效**: 触摸屏调节的参数仅在当次运行有效。若重启板子，参数会重置。建议将调好的参数记录下来，修改代码中的 `rect_binary_default` 变量以固化参数。

## 环境要求 (Requirements)

*   **硬件**: Canaan K230 开发板
*   **固件**: 建议使用 K230 SDK v1.3 或更高版本 (部分旧代码保留在 v1.2.2 目录下)
*   **软件**: CanMV IDE 或 VS Code

## 使用说明 (Usage)

1.  将代码文件复制到 K230 的 `/sdcard/` 目录下，或通过 IDE 直接运行。
2.  对于 AI 示例，请确保 SD 卡中已存入相应的 `.kmodel` 模型文件（通常在 `deploy_config.json` 中指定）。
3.  运行前请检查脚本中的配置路径。

## 许可证 (License)

MIT License
